############################################################ 
# p.133, 8.1 그래픽스와 R 
############################################################ 
  

############################################################ 
# 1. 그래픽스는 R의 장점 중 하나. 
############################################################ 
#  간단한 명령으로 보기 좋은 그래프를 작성할 수 있다. 
#  그래프의 사용자화를 아주 간단히 할 수 있다. 
#  - 저수준 작도함수로 완성된 그래프에 도형이나 문자를 추가할 수 있다. 
#  - 전용 패키지를 사용하여 사용자화 할 수 있다. 
#  복잡한 그래프나 입체적인 그래프도 간단히 그릴 수 있다. 
#  다양한 종류의 이미지를 파일로 저장할 수 있다. 
############################################################ 
 

############################################################ 
# 2. 그리기 도구 
############################################################ 
# 2-1. 작도함수 : 그래프를 출력하는 함수 
#    1) 고수준 작도함수 
#      -. 하나의 완성된 그래프를 그린다. 
#          예) 함수 plot() -> 산포도 작성 
#              함수 hist() -> 히스토그램을 작성 
#    2) 저수준 작도함수 
#       -. 완성된 그래프에 도형이나 문자를 추가한다. 
#          예) 함수 legend()를 이용하여 범례를 추가 
#          예) 함수 abline()을 이용하여 회귀직선을 추가 
# 
# 2-2. 작도 디바이스 : 그래프를 출력하는 장치(윈도우) 
#      R에서는 작도 디바이스가 어떻게 동작하는지 신경쓸 필요가 없다. 
#    1) 컴퓨터 화면에 표시하는 디바이스 
#    2) 이미지 파일로 저장하는 디바이스 
#       -. bmp() : 비트맵 형식 
#       -. jpeg() : JPEG 형식 (이미지 품질을 3단계로 선택가능) 
#       -. pdf() : Adobe pdf 형식 
#       -. pictex() : LaTex 이미지 형식 
#       -. png() : PNG 형식 
#       -. postscript() : Adobe PostScript 형식 
#       -. win.metafile() : 윈도우 메타파일 형식 
############################################################ 


############################################################ 
# p.135, 8.2 고수준 작도함수 
############################################################ 
# 고수준 작도함수는 '하나의 완성된 그래프'를 그리는 함수이다. 
############################################################ 
# 1. R에서 그래프를 작성하는 순서 
############################################################ 
#  1) 플롯할 데이터나 수식을 준비한다. 
#  2) 고수준 작도함수로 그래프를 그린다. 
#  3) 저수준 작도함수로 그래프를 장식한다. 
#  4) 완성된 그래프를 저장한다. 
############################################################ 
# 고수준 작도함수를 실행하면 자동으로 작도디바이스가 실행되어 
# 윈도우에 그래프가 표시된다. [그래프 목록 : <표 8-1>] 
############################################################ 
# 산포도      : plot(vector), plot(vector1, vector2) 
#--------------------------------------------------------------------------------------- 
# 히스토그램   : hist(vector) 
#--------------------------------------------------------------------------------------- 
# 상자수염상자  : boxplot(vector) 
#--------------------------------------------------------------------------------------- 
# 막대그래프   : barplot(각 카테고리의 빈도가 들어간 벡터) 
#--------------------------------------------------------------------------------------- 
# 원그래프     : pie(각 카테고리의 빈도가 들어간 벡터) 
#--------------------------------------------------------------------------------------- 
# 분할표 그림   : mosaicplot(행렬 데이터) 
#--------------------------------------------------------------------------------------- 
# 스타차트     :  stars(행렬 데이터) 
#--------------------------------------------------------------------------------------- 
# 산포도 행렬   : pairs(행렬 데이터) 
#--------------------------------------------------------------------------------------- 
# 1차원 함수 그래프 : curve(함수, 좌단, 우단) 
#--------------------------------------------------------------------------------------- 
# 2차원 함수 그래프 : persp(x축, y축, z축) 
############################################################ 

  

############################################################ 
# p.136, 8.2.1 plot() 함수 
#--------------------------------------------------------------------------------------- 
#  1) y축 데이터만 지정 
#--------------------------------------------------------------------------------------- 

y <- c(1,1,2,2,3,3,4,4,5,5)       # 1) 데이터 준비 
plot(y)                           # 2) 고수준 작도함수. [범위는 자동] 


#--------------------------------------------------------------------------------------- 
#  2) x축과 y축의 데이터 지정 
#--------------------------------------------------------------------------------------- 

x <- 1:10                  # 1) x축 데이터 준비 
y <- 1:10                  # 1) y축 데이터 준비 

plot(x, y)                 # 2) 그래프를 그린다. (범위는 자동 정해짐) 

#--------------------------------------------------------------------------------------- 
#  3) 수학함수를 지정해서 해당 그래프 출력  
#     -. 함수를 정의한다. : sin()함수처럼 원래 있는 함수는 정의 불필요 
#     -. 함수명을 지정해서 그린다. 
#--------------------------------------------------------------------------------------- 
#     plot(함수명, x축 함수의 하한선, y축 함수의 상한선) 
#--------------------------------------------------------------------------------------- 
#  예) 정현함수와 표준정규분포 
#--------------------------------------------------------------------------------------- 

plot(sin,  -pi, 2*pi)      # 2) 정현함수를 플롯한다  

curve(sin, -pi, 2*pi)      # 2) 함수 curve()： 위와 같은 그래프  



############################################################ 
# <삼각함수> : [http://tip.daum.net/openknow/39071274] 
# 사인함수(sine: sin): 정현(正弦)함수 
# 코사인함수(cosine: cos): 여현(餘弦)함수  
# 탄젠트함수(tangent: tan): 정접(正接)함수 
# 코시컨트함수(cosecant: cosec, csc): 여할(餘割)함수  
# 시컨트험수(secant: sec): 정할(正割)함수 
# 코탄젠트수(cotangent: cot): 여접(餘接)함수 
#--------------------------------------------------------------------------------------- 

curve(sin, -pi, 3*pi)  
curve(sin, -pi, 4*pi)   
curve(sin, -pi, 5*pi)   
curve(sin, -pi, 6*pi)  
curve(sin, -pi, pi)   

curve(sinh, -pi, pi)   

curve(cos, -pi, pi)   
curve(cos, -pi, 2*pi)   
curve(cos, -pi, 3*pi)  
curve(cos, -pi, 4*pi)   
curve(cos, -pi, 5*pi)   
curve(cos, -pi, 6*pi)  

curve(cosh, -pi, pi)   

curve(tan, -pi, pi)   
curve(tan, -pi, 2*pi)   
curve(tan, -pi, 3*pi)  

curve(tanh, -pi, pi)   

############################################################ 
# R에서의 삼각함수 
# https://stat.ethz.ch/R-manual/R-devel/library/base/html/Trig.html 
# trigonometric function in R 
#--------------------------------------------------------------------------------------- 
# cos(x) 
# sin(x) 
# tan(x) 
# 
# acos(x) 
# asin(x) 
# atan(x) 
# atan2(y, x) 
# 
# cospi(x) 
# sinpi(x) 
# tanpi(x) 
#--------------------------------------------------------------------------------------- 


#--------------------------------------------------------------------------------------- 

std_normal.density <- function(x) {      # (1) 표준정규분포의 밀도함수를 정의한다  
  1/sqrt(2*pi)*exp(-x^2/2)               #  
}                                        # 

plot(std_normal.density, -3, 3)          # (2) 표준정규분포를 플롯한다  
curve(std_normal.density,-3, 3)          # (2) 함수 curve() : 위와 같은 그래프  

#--------------------------------------------------------------------------------------- 
 

############################################################ 
# p.139, 8장 연습문제(1) 
#--------------------------------------------------------------------------------------- 
# 1. 다섯 개의 데이터 플롯 
#--------------------------------------------------------------------------------------- 
 
x <- c(1, 2, 3, 4, 5) 
y <- c(1, 4, 9, 6, 3) 

plot(x, y) 

# 데이터를 행렬로 처리한 경우 (1) 

x <- matrix(c(1,1,2,4,3,9,4,6,5,3),2,5) 
x[1,] 
x[2,] 

plot(x[1,], x[2,]) 

  

# 데이터를 행렬로 처리한 경우 (2) 

rownames(x) <- c("X", "Y") 
x 

plot(x["X",],x["Y",]) 

  

#--------------------------------------------------------------------------------------- 
# 2. 함수 f(x) = cos(x) - log(x)를 1 <= x <= 10의 범위로 플롯 
#--------------------------------------------------------------------------------------- 

f <- function(x) cos(x) - log(x)        # 함수정의 

plot(f, 1, 10)                          # 그래프 그리기 
curve(f, 1, 10)                         # 그래프 그리기 

#--------------------------------------------------------------------------------------- 
# 3. 명시적으로 변수를 지정하여 함수 플롯하기. 
#    예) f(x)= x^2 
#--------------------------------------------------------------------------------------- 

f <- function(x) {  
     return(x^2) 
} 


plot(f, -3, 3) 
curve(f, -3, 3) 
curve(f(x), -3, 3) 

  
#--------------------------------------------------------------------------------------- 
# 3. 명시적으로 변수를 지정하여 함수 플롯하기. 
#    이 방법은 함수의 인수가 2개 이상 있을 때 효과적 
#    예) f(x)= x^a 에 대해 a=2일 때의 그래프 그리기. 
#--------------------------------------------------------------------------------------- 

f <- function(x,a) {  
     return(x^a) 
} 

curve(f(x,2), -3, 3) 
curve(f(x,3), -3, 3) 
curve(f(x,4), -3, 3) 

#--------------------------------------------------------------------------------------- 
# 4. (p.140) f(x,y) = 1/(2*pi)*exp(-(x^2+y^2)/2) 
#--------------------------------------------------------------------------------------- 

f <- function(x,y) { 
     return( 1/(2*pi)*exp(-(x^2+y^2)/2) ) 
} 

curve(f(x, 0), -3, 3)        # -3 ~ 3 범위에서 y=0으로 해서 플롯  

############################################################ 
# p.140, 8.2.2 함수 plot()의 인수 
#--------------------------------------------------------------------------------------- 
#  1) p.140, 함수 plot()의 xlim과 ylim으로 범위를 명시적으로 지정할 수 있다. 
#--------------------------------------------------------------------------------------- 

x <- 1:10                        # (1) x축 데이터를 준비한다  
y <- 1:10                        # (1) y축 데이터를 준비한다   

plot(x, y, xlim=c(0,11))         # (2) 그래프를 그린다(범위를 xlim으로 정한다) 

#--------------------------------------------------------------------------------------- 
#  2) p.141 x축의 방향을 왼쪽으로 할 수도 있다. xlim=c(11,0) 
#--------------------------------------------------------------------------------------- 

plot(x, y, xlim=c(11,0))         # (2) 그래프를 그린다(범위를 xlim으로 정한다) 
                                 #  => x축의 눈금을 확인바람 (****) 


#--------------------------------------------------------------------------------------- 
#  * p. 142 <표8-2> plot()의 인수목록 
#  * p. 143 <표8-3> 인수 pch로 정할 수 있는 플롯의 종류 
#--------------------------------------------------------------------------------------- 

#--------------------------------------------------------------------------------------- 
#  3) p.144, 그래프에 제목 달기 : main = "그래프 제목" 
#--------------------------------------------------------------------------------------- 

y <- c(1, 3, 2, 4, 8, 5, 7, 6, 9) 

plot(y, main="Simple Time Series") 


#--------------------------------------------------------------------------------------- 
#  4) p.145, y축의 범위 지정 ylim=c(0,10), 점을 꺾은선(type="l") 그래프로 표시 
#--------------------------------------------------------------------------------------- 

y <- c(1, 3, 2, 4, 8, 5, 7, 6, 9) 

plot(y, ylim=c(0, 10), type = "l") 


#--------------------------------------------------------------------------------------- 
#  5) p.146, (1) 인수 type의 종류별로 선을 구분하여 그린다. 
#            (2) 범례 표시 : legend() 
#--------------------------------------------------------------------------------------- 

plot(5:9, ylim=c(0, 10), type = "p", ylab=""); par(new=T) 
plot(4:8, ylim=c(0, 10), type = "l", ylab=""); par(new=T) 
plot(3:7, ylim=c(0, 10), type = "b", ylab=""); par(new=T) 
plot(2:6, ylim=c(0, 10), type = "c", ylab=""); par(new=T) 
plot(1:5, ylim=c(0, 10), type = "o", ylab="") 
legend(4, 2.5, paste("type =", c("p","l","b","c","o"), "   ")) 

#--------------------------------------------------------------------------------------- 
#  6) p.147, 점의 종류를 변수에 대응해서 변경하고자 할 때, 
#            ifelse() 사용하여 조건 분기. 
#--------------------------------------------------------------------------------------- 

x <- runif(100) 
y <- runif(100) 

plot(x, y, pch = ifelse(y>0.5, 1, 18)) 


############################################################ 
# p.148, 8장 연습문제(2) 
#--------------------------------------------------------------------------------------- 
# 1. x 벡터 작성. (1,2,4,4,5) 
#--------------------------------------------------------------------------------------- 

x <- c(1,2,4,4,5) 
  

#--------------------------------------------------------------------------------------- 
# 2. 막대그래프 작성 
#--------------------------------------------------------------------------------------- 

plot(x, main="My Plot", type="h") 

#--------------------------------------------------------------------------------------- 
# 3. 산포도 작성 
#--------------------------------------------------------------------------------------- 

plot(x, col=2, pch=3, ann=F) 


############################################################ 
# p.149, 8.3 저수준 작도함수와 그래프의 충첩 
#--------------------------------------------------------------------------------------- 
# 8.3.1 저수준 작도함수 
############################################################ 
# 1. R에서 그래프를 작성하는 순서 
#--------------------------------------------------------------------------------------- 
#  1) 플롯할 데이터나 수식을 준비한다. 
#  2) 고수준 작도함수로 그래프를 그린다. 
#  3) 저수준 작도함수로 그래프를 장식한다.] 
#  4) 완성된 그래프를 저장한다. 
#--------------------------------------------------------------------------------------- 
#  저수준 작도함수는 완성된 그래프에 도형이나 문자 등을 추가하는 함수이다. 
############################################################ 
# * 저수준 작도함수로 작성할 수 있는 그래프이 목록 : p.150 <표 9-1> 
#--------------------------------------------------------------------------------------- 
# 점            points() 
#--------------------------------------------------------------------------------------- 
# 직선            lines(), segments(), abline() 
#--------------------------------------------------------------------------------------- 
# 격자            grid() 
#--------------------------------------------------------------------------------------- 
# 화살표        arrows() 
#--------------------------------------------------------------------------------------- 
# 직사각형        rect() 
#--------------------------------------------------------------------------------------- 
# 문자            text(), mtext(), title() 
#--------------------------------------------------------------------------------------- 
# 테두리와 축        box(), axis() 
#--------------------------------------------------------------------------------------- 
# 범례            legend() 
#--------------------------------------------------------------------------------------- 
# 다각형        polygon() 
############################################################ 
# <예제> plot()을 이용하여 그래프를 먼저 그린 다음 (고수준 함수), 
#       저수준 작도함수를 이용하여 하나씩 그래프를 장식한다.  
#--------------------------------------------------------------------------------------- 

plot(1:10)                                    # 산포도를 그린다­ 

abline(h=5)                                   # 직선 : y = 5를 추가한다  

rect(1,6, 4,9)                                # 좌측상단에 사각형을 추가한다  

arrows(1,1, 4,4)                              # 죄측하단에 화살표 추가한다   

text(8,9,"ABCD")                              # 우측상단에 문자를 추가한다  

title("main","sub")                           # 표제와 부제목을 추가한다  

legend(8,3,lty=1:3, c("P","Q","R"))           # 우측하단에 범례를 추가한다  
  

############################################################ 
# p.151, 8.3.2 그래프의 충첩 
#--------------------------------------------------------------------------------------- 
# 그래프를 겹치려면,  
#  (1) par(new=T)를 사용하거나,  
#  (2) 고수준 작도함수의 인수로 add=T를 지정한다.  
#     단, plot()이외의 함수는 add=T가 효과가 없을 때가 많음.  
#        함수 par(new=T)를 이용하는 편이 좋다. 
#--------------------------------------------------------------------------------------- 

plot(sin, -pi, pi, xlab="", ylab="", lty=2)   # sin(x)를 그린다  

par(new=T)                                    # 겹쳐 그리기 지정  

plot(cos, -pi, pi, xlab="x", ylab="y")        # cos(x)를 겹쳐 그린다  

plot(sin, -pi, pi, xlab="x", ylab="y", lty=2) # 새롭게 그래프를 그린다  

plot(cos, -pi, pi, add=T)                     # cos(x)를 겹쳐 그린다  

  

#--------------------------------------------------------------------------------------- 
# 그래프를 중첩하는 예,  
#  * 두 개의 그래프를 하나로 겹쳐서 표시, 
#  1)  f(x, a) = {1/(1+exp(-a-x))  
#--------------------------------------------------------------------------------------- 

F <- function(x,a) {1/(1+exp(-a-x))}       # 작도하는 함수  

#--------------------------------------------------------------------------------------- 
#  2)  par()를 사용하면 그래프를 하나로 표시할 수 있지만. 
#      인수에 아무런 지정도 하지 않으면, x축과 y축이 각각 중복되어 엄망이 됨. 
#--------------------------------------------------------------------------------------- 

curve(F(x,-1), col=1) 

par(new=T)                                    # 앞의 그래프를 남겨둔 채로 다음 그래프를 그린다 

curve(F(x, 1), col=2) 

#--------------------------------------------------------------------------------------- 
#  3)  xlim과 ylim을 인수로 지정하여 두 그래프의 자표를 맞춤. 
#      * 그래도 y축 라벨은 이상함. 
#--------------------------------------------------------------------------------------- 

curve(F(x,-1), col=1, xlim=c(-5,5), ylim=c(0,1)) 

par(new=T) 

curve(F(x, 1), col=2, xlim=c(-5,5), ylim=c(0,1)) 

#--------------------------------------------------------------------------------------- 
#  4)  첫 번째 인수 ylab을 ylab=""(공백)으로 하고, 
#      두 번째 ylab="F(x,a)"로 y축 라벨을 지정 
#      ==> 그래프가 어느 정도 완성됨. 
#--------------------------------------------------------------------------------------- 

curve(F(x,-1), col=1, xlim=c(-5,5),  ylim=c(0,1), ylab="") 

par(new=T) 

curve(F(x, 1), col=2, xlim=c(-5,5),  ylim=c(0,1), ylab="F(x)") 
 

#--------------------------------------------------------------------------------------- 
#  5)  마지막으로 그래프의 제목(인수 main="그래프의 중첩")과 
#      범례(legend() 함수 사용)를 붙여서 완성한다. 
#--------------------------------------------------------------------------------------- 

curve(F(x,-1), col=1, xlim=c(-5,5),  ylim=c(0,1), ylab="") 

par(new=T) 

curve(F(x, 1), col=2, xlim=c(-5,5),  ylim=c(0,1), ylab="F(x)", main="그래프의 중첩") 

legend(3, 0.4, c("a = -1","a =  1"), lty=1, col=1:2) 

  

  

############################################################ 

# p.153, 8장 연습문제(3) 

#--------------------------------------------------------------------------------------- 

# 1. 벡터 y에 대해, x축 라벨은 없고, y축 라벨은 '빈도'로 한다. 

#    막대그래프의 굵기를 굵게하요 작성하라. 

#--------------------------------------------------------------------------------------- 

  

y <- c(1, 3, 2, 4, 8, 5, 7, 6, 9) 

plot(y, xlab="", ylab="빈도", type ="h", lwd=5) 

  

#--------------------------------------------------------------------------------------- 

# 2. 1.에서 작성한 막대그래프에 저수즌 작도함수를 이용하여 

#    1) '막대그래프'라는 제목을 붙여라. 

#    2) y=5, 색은 'gray' 선을 추가하고,  

#    3) 가장 긴 막대에 화살표를 하고 '톱'이라는 문자를 붙여라. 

#--------------------------------------------------------------------------------------- 

  

title("막대 그래프") 

lines(c(0,10), c(5,5), col="gray")       # abline(h=5, col="gray")도 가능 

arrows(8,9, 9,9) 

text(7.5, 9, "톱") 

  

#--------------------------------------------------------------------------------------- 

# 3. 함수 f(x) = x^a을 정의하라. 

#--------------------------------------------------------------------------------------- 

  

f <- function(x, a) { 

  return(x^a) 

} 

  

#--------------------------------------------------------------------------------------- 

# 4. 함수 f(x) = x^a에 대하여,  

#        1) a=1, 2, 3일 떄의 세 종류 그래프를 종합하고, 

#        2) -2 <= x <= 2, -2 <= y <= 2의 범위로 플롯하라. 

#--------------------------------------------------------------------------------------- 

  

curve(f(x,1), xlim=c(-2,2), ylim=c(-2,2), lty=1, xlab="", ylab="") 

par(new=T) 

curve(f(x,2), xlim=c(-2,2), ylim=c(-2,2), lty=2, xlab="", ylab="") 

par(new=T) 

curve(f(x,3), xlim=c(-2,2), ylim=c(-2,2), lty=3, xlab="x", ylab="f(x,a)", main="그래프 중첩") 

  

  

############################################################ 

# p.155, 8.4 그래프의 저장 

############################################################ 

# R에서 그래프를 작성하는 순서 

#--------------------------------------------------------------------------------------- 

# 1. 플롯할 데이터나 수식 준비 

# 2. 고수준 작도함수로 그래프를 그린다. 

# 3. 저수준 작도함수로 그래프를 장식한다. 

# [4. 완성된 그래프를 저장한다.] 

#--------------------------------------------------------------------------------------- 

# 완성된 그래프의 저장순서 

#--------------------------------------------------------------------------------------- 

# 1. 저장할 작업 디렉토리를 지정한다. 

# 2. 작도 디바이스를 연다. (파일명을 지정한다.) 

# 3. 플롯한다.  

# 4. 작도 디바이스를 다는다. (이 시점에 파일이 완성된다.) 

#--------------------------------------------------------------------------------------- 

  

############################################################ 

# p.156, 8.4.1 작업 디렉토리 변경 

#--------------------------------------------------------------------------------------- 

  

setwd("c:/usr")            # 경로구분자를 '/'로 사용해야 함. 

getwd()                    # 현재 작업 디렉터리를 표시  

  

############################################################ 

# p.157, 8.4.2 작도 디바이스와 그래프의 저장 

############################################################ 

# R에서 그래프를 작성하는 순서 

#--------------------------------------------------------------------------------------- 

# R이 지원하는 작도 디바이스는 help("Devices")로 조사해 볼 수 있다. 

#--------------------------------------------------------------------------------------- 

# * 대표적인 작도 디바이스 목록 : p. 157 <표 8-5> 

#--------------------------------------------------------------------------------------- 

#   bitmap(), bmp()    윈도우 비트맵 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   dev2bitmap()        윈도우 비트맵 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   dev.copy2eps()    eps 형식으로 복사 

#--------------------------------------------------------------------------------------- 

#   dev.copy2pdf()    PDF 형식으로 복사 

#--------------------------------------------------------------------------------------- 

#   jpeg()            JPEG 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   pdf()            PDF 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   pictex()        pictex 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   png()            PNG 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   postscript()        포스트스크립트 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   tiff()            tiff 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   win.metafile()    윈도우 EMF 형식으로 출력 

#--------------------------------------------------------------------------------------- 

#   xfig()            xfig 형식으로 출력 

#--------------------------------------------------------------------------------------- 

  

  

#--------------------------------------------------------------------------------------- 

# [함수 작성 예] 

#--------------------------------------------------------------------------------------- 

# 1) png(파일명, 그래프의 폭, 그래프의 높이) 

#--------------------------------------------------------------------------------------- 

  

png(filename = "filename.png", width = 480, height = 480, 

    pointsize = 12, bg = "white") 

  

#--------------------------------------------------------------------------------------- 

# 2) PDF 파일로 저장 : pdf(file="파일명.pdf") 

#--------------------------------------------------------------------------------------- 

  

pdf(file="filename.pdf")            # pdf 장치를 연다  

plot(1:10)                          # 플롯한다  

dev.off()                           # 장치를 닫는다  

  

#--------------------------------------------------------------------------------------- 

# 3) EPS 형식으로 저장 : postscript(file="파일명.pdf", ... ) 

#--------------------------------------------------------------------------------------- 

  

postscript(file="filename.eps", horizontal = FALSE, onefile = FALSE,  

           paper="special" , height=9, width=14) 

plot(1:10)                          # 플롯한다  

dev.off()                           # 장치를 닫는다  

  

#--------------------------------------------------------------------------------------- 

# 4) dev.copy() 등을 사용해서, 그래프 윈도(작도디바이스)에 그려진  

#    그래프를 이미지 파일로 복사할 수도 있다. 

#--------------------------------------------------------------------------------------- 

  

plot(1:10)                          # 그래프를 그린 다음  

dev.copy(pdf, "filename.pdf")       # pdf로 저장한다  

dev.copy2eps(file="finename.eps")   # eps로 저장한다  

dev.off()                           # 파일을 닫는다  

  

#--------------------------------------------------------------------------------------- 

# [주의] 작업 디렉토리에 전체 경로를 지정하면, 파일을 저장하는 디렉토리를  

#       임시로 변경할 수 있다. 

#--------------------------------------------------------------------------------------- 

  

pdf(file="c:/filename.pdf")         # pdf 장치를 연다  

plot(1:10)                          # 플롯한다  

dev.off()                           # 장치를 닫는다  

  

#--------------------------------------------------------------------------------------- 

# [주의] 윈도우 버전 R에서는 그래프 윈도위를 우클릭하거나, 그래프 윈도우에서 

#     [파일]-[다른 이름으로 저장] 메뉴를 선택하여 그래프를 파일로 저장가능. 

#--------------------------------------------------------------------------------------- 

  

  

############################################################ 

# p.160, 8.5 보충학습 

############################################################ 

# P.160, 8.5.1. 그래프 제거 

#--------------------------------------------------------------------------------------- 

# 작성한 그래프의 제거 : frame() 또는 plot.new() 사용 

#--------------------------------------------------------------------------------------- 

  

frame() 

plot.new()   

  

############################################################ 

# P.160, 8.5.2 확률분포의 플롯 

#--------------------------------------------------------------------------------------- 

# 확률함수나 밀도함수를 R의 함수로 정의한 후 그래프를 그림. 

# R에 원래부터 준비된 확률분포는 그 함수를 이용해서 플롯함. 

#--------------------------------------------------------------------------------------- 

  

#--------------------------------------------------------------------------------------- 

# p.160, 1) 이항분포의 확률함수 그리기 

#--------------------------------------------------------------------------------------- 

  

x <- 0:10 

plot(x, dbinom(x,10,0.5), type="h", lwd=5) 

  

#--------------------------------------------------------------------------------------- 

# p.161, 2) 정규분포의 밀도함수 그리기 

#--------------------------------------------------------------------------------------- 

  

curve(dnorm, -4, 4, type="l") # 플롯  

xvals <- seq(2, 4, length=10) # 2~4까지에 그림자를 추가  

dvals <- dnorm(xvals) 

polygon(c(xvals,rev(xvals)), c(rep(0,10),rev(dvals)),col="gray") 

  

#--------------------------------------------------------------------------------------- 

# p.162, * R에 준비되어 있는 확률분포 목록 : <표 8-6> 

#--------------------------------------------------------------------------------------- 

#   베타분포                dbeat 

#   로지스틱 분포            dlogis 

#   이항분포                dbinom 

#   다항분포                dmultinom 

#   코시분포                dcauchy 

#   부의 이항분포            dnbinom 

#   카이제곱분포            dchisq 

#   정규분포                dnorm 

#   지수분포                dexp 

#   푸아송분포                dpois 

#   F분포                df 

#   윌콕슨의 부호부 순위합동 계량분포    dsignrank 

#   감마분포                dgamma 

#   t분포                dt 

#   기하분포                dgeom 

#   일양분포                dunif 

#   초기하분포                dhyper 

#   와이블분포                dweibull 

#   로그정규분포            dlnorm 

#   윌콕슨의 순의합동 계량분포    dwilcox 

#--------------------------------------------------------------------------------------- 

 

############################################################ 

# P.162, 8.5.3 3차원 플롯 

#--------------------------------------------------------------------------------------- 

#  <3차원 플롯 순서> 

#--------------------------------------------------------------------------------------- 

#  1. x 방향의 분점(범위와 점의 수: 점의 수는 length 옵션으로 지정)과  

#     y방향으로의 분점을 생성한다. 

#--------------------------------------------------------------------------------------- 

#  2. 플롯할 함수를 정의한다. (sin() 등과 같이 원래있는 함수는 정의 불필요) 

#--------------------------------------------------------------------------------------- 

#  3. z방향의 분점을 생성한다. 

#--------------------------------------------------------------------------------------- 

#  4. 함수 persp()에 x,y,z를 지정하여 플롯한다. 

############################################################ 

#                    persp() 함수의 형식 

#--------------------------------------------------------------------------------------- 

#  persp(x축 데이터, y축 데이터, z축 데이터, col=색,  

#        theta=가로회전각도, phi=세로회전각도, expand=확대율) 

############################################################ 

  

#--------------------------------------------------------------------------------------- 

# 2차원 표준정규분포의 밀도함수의 그래프를 -3 <= x <= 3 범위로 플롯하기. 

#--------------------------------------------------------------------------------------- 

  

x <- seq(-3, 3, length= 61)         # x축 방향의 분점  

y <- x                              # y축 방향의 분점  

f <- function(x, y) {               # 2차원 정규분포 함수  

  return( 1/(2*pi)*exp(-(x^2+y^2)/2) ) 

} 

z <- outer(x, y, f)                 # z방향의 크기를 구한다  

persp(x, y, z, theta=30, phi=30, expand=0.5, col="lightblue") 

options(repos="http://cran.md.tsukuba.ac.jp") 

  

  

############################################################ 

# P.164, 8.5.4 rgl 패키지 

#--------------------------------------------------------------------------------------- 

#  rgl 패키지를 사용하면 3차원 점 플롯이나, 그래프를 그릴 수 있다. 

#  마우스 조작으로 그래프의 이동, 확대, 그리고 축소 등이 가능하다. 

#--------------------------------------------------------------------------------------- 

#      install.packages("rgl") 

#      library(rgl) 

#--------------------------------------------------------------------------------------- 

  

# options(repos="http://biostat.cau.ac.kr/CRAN") 

  

install.packages("rgl")            # rgl 패키지 설치 

library(rgl)                # rgl 패키지 호출 

example(rgl.surface)            #  

for (i in 1:360) rgl.viewpoint(i,i/4) 

  

#--------------------------------------------------------------------------------------- 

# p.164 다음 플롯 실행을 위해 도형 제거 : clear3d() 

#--------------------------------------------------------------------------------------- 

  

clear3d()                           # 도형을 제거  

clear3d(type="lights")              # 광원 설정을 제거  

clear3d(type="all")                 # bounding-box 설정 제거  

  

#--------------------------------------------------------------------------------------- 

# p.164 3차원 산포도 : plot3d(x좌표 점, y좌표 점, z좌표 점) 

# 도형을 마우스 왼쪽 버튼을 누르고 이동, 회전, 마우스 휠로 확대, 축소 가능 

#--------------------------------------------------------------------------------------- 

 

x <- rnorm(100)                     # x축 데이터 준비  

y <- rnorm(100)*2                   # y축 데이터 준비  

z <- rnorm(100)*3                   # z축 데이터 준비  

plot3d(x, y, z)                     # 3차원 산포도 그리기  

  

#--------------------------------------------------------------------------------------- 

# p.165 3차원 함수 그리기 : persp3d(x좌표 data, y좌표 data, z좌표 data, col=색) 

#--------------------------------------------------------------------------------------- 

 

x <- seq(-10, 10, length= 51) 

y <- x 

  

f <- function(x,y) {  

     r <- sqrt(x^2+y^2); 10 * sin(r)/r  

} 

  

z <- outer(x, y, f) 

  

persp3d(x, y, z, aspect=c(1, 1, 0.5), col="lightblue", 

        xlab="X", ylab="Y", zlab="") 

  

#--------------------------------------------------------------------------------------- 

# p.166 그래프 저장 : snapshot3d() 이용 PNG 형식으로 저장 

#      rgl.postscript()의 두번째 인수로 ps, eps, tex, pdf, svg, pgf 

#      중 하나를 지정해서 그래프 저장 형식을 지정 

#--------------------------------------------------------------------------------------- 

  

snapshot3d("p-165.png") 

rgl.postscript("p-164.pdf", "pdf", drawText=FALSE) 

  

#--------------------------------------------------------------------------------------- 

#   p.166 패키지 rgl에 준비된 함수 목록 

#--------------------------------------------------------------------------------------- 

  

  

############################################################ 

# p.167, 8장 연습문제(4) 

#--------------------------------------------------------------------------------------- 

  

#--------------------------------------------------------------------------------------- 

# 1. 함수 persp()를 사용하여,   

#    f(x,y) = sin(sqrt(x^2+y^2))/sqrt(x^2+y^2+1) 

#    를  -10 <= x <= 10 범위에서 플롯하라. 

#--------------------------------------------------------------------------------------- 

  

x <- seq(-10, 10, length= 101)         # x 방향의 분점 

y <- x                                 # y 방향의 분점  

  

f <- function(x,y) { 

  sin(sqrt(x^2+y^2))/sqrt(x^2+y^2+1)   # 플롯할 함수  

} 

  

z <- outer(x, y, f)                    # z 방향의 크기를 구한다  

persp(x, y, z, theta=30, phi=30, expand=0.5, col="lightblue") 

  

#--------------------------------------------------------------------------------------- 

# 1. 함수 persp3d()를 사용하여,   

#--------------------------------------------------------------------------------------- 

  

x <- seq(-10, 10, length= 101)         # x 방향의 분점  

y <- x                                 # y 방향의 분점  

  

f <- function(x,y) { 

  sin(sqrt(x^2+y^2))/sqrt(x^2+y^2+1)   # 플롯할 함수  

} 

  

z <- outer(x, y, f)                    # z방향의 크기를 구한다   

persp3d(x, y, z, aspect=c(1, 1, 0.5), col="lightblue", 

        xlab="X", ylab="Y", zlab="") 

  

  

############################################################ 

 